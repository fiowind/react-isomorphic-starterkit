<html lang="utf-8">

<head>
    <title>邀请赢大奖</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="keywords" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" type="text/css" href="/winaward/a/static/app.css">
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-80835016-1', 'auto');          // 新添 tracker code
        ga('create', 'UA-80835016-3', 'auto', 'one');   // 新添 tracker code
        ga('create', 'UA-78954914-1', 'auto', 'old');   // 原有 tracker code
        function getCookie(name) {
            var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");
            if (arr = document.cookie.match(reg))
                return decodeURIComponent(arr[2]);
            else
                return '';
        }

        if (getCookie('unionid') ) {
            ga('set', 'userId', getCookie('nickname'))
            ga('one.set', 'userId', getCookie('nickname') + '_' + getCookie('unionid'));
            ga('old.set', 'userId', getCookie('nickname') + '_' + getCookie('unionid'));
        }
        ga('send', 'pageview');
        ga('one.send', 'pageview');
        ga('old.send', 'pageview');

    </script>
    <script src="//res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
    <script type='text/javascript'>
      var _vds = _vds || [];
      window._vds = _vds;
      (function(){
        _vds.push(['setAccountId', 'b38f75bf1c09abad']);
        if (getCookie('unionid') && getCookie('nickname')) {
          _vds.push(['setCS1', 'user_id', getCookie('unionid')+ '_' + getCookie('nickname')]);
        }
        (function() {
          var vds = document.createElement('script');
          vds.type='text/javascript';
          vds.async = true;
          vds.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'dn-growing.qbox.me/vds.js';
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(vds, s);
        })();
      })();
    </script>
</head>

<body>
<script>
    !(function (win, doc) {
        function setFontSize() {
            // 获取window 宽度
            // zepto实现 $(window).width()就是这么干的
            var winWidth = window.innerWidth;
            doc.documentElement.style.fontSize = (winWidth / 640) * 100 + 'px';
        }
        var evt = 'onorientationchange' in win ? 'orientationchange' : 'resize';
        var timer = null;
        win.addEventListener(evt, function () {
            clearTimeout(timer);
            timer = setTimeout(setFontSize, 300);
        }, false);
        win.addEventListener("pageshow", function (e) {
            if (e.persisted) {
                clearTimeout(timer);
                timer = setTimeout(setFontSize, 300);
            }
        }, false);
        // 初始化
        setFontSize();
    }(window, document));
</script>
<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-NFH3B5"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NFH3B5');</script>
<!-- End Google Tag Manager -->
<div id="root"></div>
<script src="/winaward/a/static/bundle.js""></script>
</body>

<script src="https://mvp.youqiantu.com/rqz/a/static/js/fastclick.js"></script>

<script>
    (function(p, l, o, w, i, n, g) {
        if (!p[i]) {
            p.GlobalDrNamespace = p.GlobalDrNamespace || [];
            p.GlobalDrNamespace.push(i);
            p[i] = function() {
                (p[i].q = p[i].q || []).push(arguments)
            };
            p[i].q = p[i].q || [];
            n = l.createElement(o);
            g = l.getElementsByTagName(o)[0];
            n.async = 1;
            n.src = w;
            g.parentNode.insertBefore(n, g)
        }
    }(window, document, "script", "https://t.yqtcdn.net/tracker-v1.0.2.js", "dr"));

    window.dr('newTracker', 'dr', getCookie('drHost'), {
        encodeBase64: false,
        appId: getCookie('appId'),
        platform: 'web',
        useCookies: false
    });
    if(getCookie("unionid")) {
        window.dr('setUserId', getCookie("unionid"));
    }
    window.dr('trackPageView');
</script>

<script type="text/javascript">
    function appendRefuid2Url(url){
        url = url || window.location.href;
        var parts = (url || '').split('#');
        var appendedUrl = parts[0].replace(/[?&]refuid=\d*/,'') + (parts[0].replace(/[?&]refuid=\d*/,'').indexOf('?') === -1 ? '?':'&')
        + "refuid=" + (getCookie("unionid") || 0);
        return appendedUrl + (parts.length === 1 ? '' :('#' + parts[1].split('?')[0]));
    }
    var xhr = new XMLHttpRequest()
    xhr.open('GET', 'api/mvp/share/config?' + 'url=' + encodeURIComponent(location.href))
    xhr.responseType = 'json'
    xhr.addEventListener('load', function () {
        var wxConfig = xhr.response
        var activity={
            service_name:"邀请赢大奖",
            description:"邀请赢大奖",
            service_banner: 'https://mvp.youqiantu.com/rqz/a/static/images/wechatshare.png',
            link: appendRefuid2Url()
        };

        wx.config({
            debug: false,
            appId: wxConfig.app_id,
            timestamp: wxConfig.timestamp,
            nonceStr: wxConfig.nonce,
            signature: wxConfig.signature,
            jsApiList: [
                'checkJsApi',
                'onMenuShareTimeline',
                'onMenuShareAppMessage',
                'onMenuShareQQ',
                'onMenuShareWeibo'
            ]
        });

        wx.ready(function () {
            var webchatObj = {
                title: activity.service_name,
                content: activity.description
            };
            wx.onMenuShareTimeline({
                title: webchatObj.title, // 分享标题
                link: activity.link , // 分享链接
                imgUrl: activity.service_banner, // 分享图标
                success: function () {
                    // 用户确认分享后执行的回调函数
                    window.dr('trackUnstructEvent', {
                        schema: 'share',
                        data: {}
                    });
                },
                cancel: function () {
                    // 用户取消分享后执行的回调函数
                }
            });

            wx.onMenuShareAppMessage({
                title: webchatObj.title, // 分享标题
                desc: webchatObj.content, // 分享描述
                link: activity.link , // 分享链接 分享链接
                imgUrl: activity.service_banner, // 分享图标
                type: '', // 分享类型,music、video或link，不填默认为link
                dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
                success: function () {
                    // 用户确认分享后执行的回调函数
                    window.dr('trackUnstructEvent', {
                        schema: 'share',
                        data: {}
                    });
                },
                cancel: function () {
                    // 用户取消分享后执行的回调函数
                }
            });
            wx.onMenuShareQQ({
                title: webchatObj.title, // 分享标题
                desc: webchatObj.content, // 分享描述
                link: activity.link , // 分享链接分享链接
                imgUrl: activity.service_banner, // 分享图标
                type: '', // 分享类型,music、video或link，不填默认为link
                dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
                success: function () {
                    // 用户确认分享后执行的回调函数
                    window.dr('trackUnstructEvent', {
                        schema: 'share',
                        data: {}
                    });
                },
                cancel: function () {
                    // 用户取消分享后执行的回调函数
                }
            });
        })
    })
    xhr.send()
</script>
<script>
    FastClick.attach(document.body);
</script>

</html>
